{% extends "admin/base.html" %}
{% block title %}SasksVoice Admin — Settings{% endblock %}

{% block content %}
<div class="admin-header">
    <h1><i class="bi bi-gear-fill"></i> System Settings</h1>
    <p>Configure platform behavior</p>
</div>

<div class="detail-card">
    <form method="POST" action="{{ url_for('admin.settings') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <div class="settings-grid">
            <div class="setting-item">
                <label class="form-label fw-semibold">Auto Publish</label>
                <select name="setting_auto_publish" class="form-select">
                    <option value="false" {{ 'selected' if settings.get('auto_publish')=='false' }}>Disabled — Admin
                        must manually publish</option>
                    <option value="true" {{ 'selected' if settings.get('auto_publish')=='true' }}>Enabled — Posts
                        auto-publish after passing moderation</option>
                </select>
                <small class="text-muted">When enabled, free posts that pass moderation are automatically published to
                    Instagram without admin approval.</small>
            </div>

            <div class="setting-item">
                <label class="form-label fw-semibold">Require Admin Approval</label>
                <select name="setting_require_approval" class="form-select">
                    <option value="true" {{ 'selected' if settings.get('require_approval')=='true' }}>Yes — Admin must
                        approve every post</option>
                    <option value="false" {{ 'selected' if settings.get('require_approval','false')=='false' }}>No —
                        Skip admin approval</option>
                </select>
                <small class="text-muted">If "Yes", all posts wait for admin approval even if Auto Publish is enabled.
                    Set to "No" for fully automated publishing.</small>
            </div>

            <div class="setting-item">
                <label class="form-label fw-semibold">Free Post Limit (per day)</label>
                <input type="number" name="setting_free_post_limit_per_day" class="form-control"
                    value="{{ settings.get('free_post_limit_per_day', '5') }}" min="1" max="100">
                <small class="text-muted">Maximum number of free posts per IP per day.</small>
            </div>

            <div class="setting-item">
                <label class="form-label fw-semibold">Max Caption Length</label>
                <input type="number" name="setting_max_caption_length" class="form-control"
                    value="{{ settings.get('max_caption_length', '2200') }}" min="10" max="5000">
            </div>

            <div class="setting-item">
                <label class="form-label fw-semibold">Block Links in Captions</label>
                <select name="setting_block_links" class="form-select">
                    <option value="true" {{ 'selected' if settings.get('block_links')=='true' }}>Yes — Block all URLs
                    </option>
                    <option value="false" {{ 'selected' if settings.get('block_links')=='false' }}>No — Allow URLs
                    </option>
                </select>
            </div>

            <div class="setting-item">
                <label class="form-label fw-semibold">Promotional Post Price</label>
                <input type="text" class="form-control" value="$2.00 (Fixed)" disabled>
                <small class="text-muted">Promotional posts are fixed at $2 and auto-publish after payment.</small>
            </div>
        </div>

        <button type="submit" class="btn btn-primary mt-4">
            <i class="bi bi-check-lg"></i> Save Settings
        </button>
    </form>
</div>
{% endblock %}